<!DOCTYPE html>
<html>
<head>
  <title>Collaborative Whiteboard</title>
  <style>
    #canvas {
      border: 1px solid black;
    }
  </style>
</head>
<body>
  <canvas id="canvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('canvas');
    const context = canvas.getContext('2d');
    let isDrawing = false;
  
    // WebSocket Connection
    const socket = new WebSocket('ws://localhost:8080');
  
    socket.onopen = function() {
      console.log('WebSocket connection established.');
    };
  
    socket.onmessage = function(event) {
      const data = JSON.parse(event.data);
      if (data.type === 'draw') {
        drawLine(data.x0, data.y0, data.x1, data.y1, data.color);
      }
    };
  
    socket.onclose = function() {
      console.log('WebSocket connection closed.');
    };
  
    // Drawing Functions
    function startDrawing(event) {
      isDrawing = true;
      const { offsetX, offsetY } = event;
      socket.send(JSON.stringify({ type: 'draw', x0: offsetX, y0: offsetY, color: 'black' }));
    }
  
    function draw(event) {
      if (!isDrawing) return;
      const { offsetX, offsetY } = event;
      socket.send(JSON.stringify({ type: 'draw', x0: event.offsetX, y0: event.offsetY, x1: offsetX, y1: offsetY, color: 'black' }));
      drawLine(event.offsetX, event.offsetY, offsetX, offsetY, 'black');
    }
  
    function stopDrawing() {
      isDrawing = false;
    }
  
    function drawLine(x0, y0, x1, y1, color) {
      context.beginPath();
      context.moveTo(x0, y0);
      context.lineTo(x1, y1);
      context.strokeStyle = color;
      context.lineWidth = 2;
      context.stroke();
      context.closePath();
    }
  
    // Event Listeners
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);
  </script>
</body>
</html>
