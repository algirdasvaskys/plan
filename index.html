<!DOCTYPE html>
<html>
<head>
  <title>Collaborative Text Editor</title>
  <style>
    #editor {
      width: 600px;
      height: 400px;
      border: 1px solid #ccc;
      padding: 10px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      line-height: 1.5;
      white-space: pre-wrap;
      overflow-y: scroll;
    }
  </style>
</head>
<body>
  <div id="editor" contenteditable="true"></div>

  <script>
    const editor = document.getElementById('editor');
    let isTyping = false;

    // WebSocket Connection
    const socket = new WebSocket('ws://localhost:8080');

    socket.onopen = function() {
      console.log('WebSocket connection established.');
    };

    socket.onmessage = function(event) {
      const data = JSON.parse(event.data);
      if (data.type === 'text') {
        receiveText(data.text);
      }
    };

    socket.onclose = function() {
      console.log('WebSocket connection closed.');
    };

    // Send Text
    function sendText() {
      const text = editor.textContent;
      const data = { type: 'text', text };
      socket.send(JSON.stringify(data));
    }

    // Receive Text
    function receiveText(text) {
      isTyping = true;
      editor.textContent = text;
      isTyping = false;
    }

    // Event Listeners
    editor.addEventListener('input', function() {
      if (!isTyping) {
        sendText();
      }
    });
  </script>
</body>
</html>
